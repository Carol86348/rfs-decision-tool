
<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>再餵食症候群決策輔助工具</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    h2 { color: #003366; }
    table, th, td { border: 1px solid #ccc; border-collapse: collapse; padding: 8px; text-align: left; }
    table { width: 100%; margin-bottom: 20px; }
    input[type=number] { width: 80px; }
    .result { font-weight: bold; font-size: 1.2em; margin-top: 10px; }
    button { padding: 6px 12px; margin-top: 8px; cursor: pointer; }
  </style>
</head>
<body>
  <h2>再餵食症候群決策輔助工具</h2>

  <div>
    <h3>基本資料</h3>
    <label>身高（cm）<input type="number" id="height" /></label><br/>
    <label>體重（kg）<input type="number" id="weight" /></label><br/>
    <button id="bmiBtn">計算 BMI</button>
    <p id="bmiResult"><strong>BMI：</strong></p>
  </div>

  <hr/>

  <div>
    <h3>風險因子評估（BMI / 體重減輕 / 禁食 條件 三選一）</h3>
    <table>
      <tr><th>A 類</th><th>B 類</th><th>C 類</th></tr>
      <tr>
        <td><input type="checkbox" class="group-bmi" id="a_bmi" /> BMI &lt; 18.5</td>
        <td><input type="checkbox" class="group-bmi" id="b_bmi" /> BMI &lt; 16</td>
        <td><input type="checkbox" class="group-bmi" id="c_bmi" /> BMI &lt; 14</td>
      </tr>
      <tr>
        <td><input type="checkbox" class="group-weightloss" id="a_wl" /> 體重減輕 &gt; 10%</td>
        <td><input type="checkbox" class="group-weightloss" id="b_wl" /> 體重減輕 &gt; 15%</td>
        <td><input type="checkbox" class="group-weightloss" id="c_wl" /> 體重減輕 &gt; 20%</td>
      </tr>
      <tr>
        <td><input type="checkbox" class="group-intake" id="a_intake" /> 進食量 &lt; 1000 kcal 或禁食 &gt; 5 天</td>
        <td><input type="checkbox" class="group-intake" id="b_intake" /> 進食量 &lt; 1000 kcal 或禁食 &gt; 10 天</td>
        <td><input type="checkbox" class="group-intake" id="c_intake" /> 禁食 &gt; 15 天</td>
      </tr>
      <tr>
        <td><input type="checkbox" id="a_other" /> 酒精或藥物成癮病史</td>
        <td><input type="checkbox" id="b_other" /> 低血鉀 / 低血磷 / 低血鎂</td>
        <td></td>
      </tr>
    </table>
    <button id="riskBtn">▶ 評估風險等級</button>
    <p id="riskResult" class="result">尚未評估</p>
  </div>

  <script>
    document.getElementById("bmiBtn").addEventListener("click", function () {
      const height = parseFloat(document.getElementById("height").value);
      const weight = parseFloat(document.getElementById("weight").value);
      if (height > 0 && weight > 0) {
        const bmi = weight / Math.pow(height / 100, 2);
        document.getElementById("bmiResult").innerHTML = "<strong>BMI：</strong>" + bmi.toFixed(1);

        // 自動勾選對應 BMI 選項
        if (bmi < 14) document.getElementById("c_bmi").checked = true;
        else if (bmi < 16) document.getElementById("b_bmi").checked = true;
        else if (bmi < 18.5) document.getElementById("a_bmi").checked = true;
      } else {
        alert("請輸入正確的身高與體重");
      }
    });

    
    function setupCancelableExclusive(className) {
      const boxes = document.querySelectorAll("." + className);
      boxes.forEach((box) => {
        box.addEventListener("change", () => {
          if (box.checked) {
            boxes.forEach((b) => {
              if (b !== box) b.checked = false;
            });
          }
        });
      });
    }
    setupCancelableExclusive("group-bmi");
    setupCancelableExclusive("group-weightloss");
    setupCancelableExclusive("group-intake");
document.getElementById("riskBtn").addEventListener("click", function () {
      const a = ["a_bmi", "a_wl", "a_intake", "a_other"].filter(id => document.getElementById(id).checked).length;
      const b = ["b_bmi", "b_wl", "b_intake", "b_other"].filter(id => document.getElementById(id).checked).length;
      const c = ["c_bmi", "c_wl", "c_intake"].filter(id => document.getElementById(id).checked).length;

      let level = "尚未符合風險評估條件";
      if (c >= 1) level = "⚠️ 高風險";
      else if (b >= 2) level = "⚠️ 中度風險";
      else if (a >= 2 || b === 1) level = "⚠️ 低度風險";

      document.getElementById("riskResult").innerText = level;
    });
  </script>
</body>
</html>
